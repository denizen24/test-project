openapi: 3.0.0
paths:
  /:
    get:
      operationId: AppController_getHello
      parameters: []
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                type: string
  /signin:
    post:
      operationId: AuthController_signin
      summary: Войти в систему
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SignInRequestBody'
      responses:
        '201':
          description: Успешный вход в систему
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SigninResponseBodyOK'
        '401':
          description: Неверное имя пользователя или пароль
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SigninResponseBodyNotOK'
      tags: &ref_0
        - auth
  /signup:
    post:
      operationId: AuthController_signup
      summary: Регистрация
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SignUpRequestBody'
      responses:
        '201':
          description: Успешная регистрация
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SigninResponseBodyOK'
        '400':
          description: Некорректные данные
        '409':
          description: Аккаунт уже существует
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SignupResponseBodyNotOK'
      tags: *ref_0
  /refresh-token:
    post:
      operationId: AuthController_refreshToken
      summary: Обновить токен
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RefreshRequestBody'
      responses:
        '201':
          description: accessToken успешно обновлен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/refreshTokenResponseBodyOK'
        '401':
          description: Невалидный refreshToken
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/refreshTokenResponseBodyNotOK'
      tags: *ref_0
  /yandex/exchange:
    post:
      operationId: AuthController_exchangeCodeYandex
      summary: Авторизация через Yandex
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CodeFlowAuthRequestBody'
      responses:
        '201':
          description: Успешная регистрация
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SigninResponseBodyOK'
      tags: *ref_0
  /mailru/exchange:
    post:
      operationId: AuthController_exchangeCodeMail
      summary: Авторизация через Mail
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CodeFlowAuthRequestBody'
      responses:
        '201':
          description: Успешная регистрация
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SigninResponseBodyOK'
      tags: *ref_0
  /vkontakte:
    get:
      operationId: AuthController_vkontakteAuth
      summary: Авторизация через Вконтакте
      parameters: []
      responses:
        '200':
          description: Успешная регистрация
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SigninResponseBodyOK'
      tags: *ref_0
  /google:
    get:
      operationId: AuthController_googleAuth
      summary: Авторизация через Google
      parameters: []
      responses:
        '200':
          description: Успешная регистрация
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SigninResponseBodyOK'
      tags: *ref_0
  /telegram:
    post:
      operationId: AuthController_telegramCallback
      parameters: []
      responses:
        '201':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Account'
      tags: *ref_0
  /reset-password:
    post:
      operationId: AuthController_resetPassword
      summary: Сброс пароля
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ResetPasswordRequestBody'
      responses:
        '201':
          description: Ссылка для сброса пароля отправлена на указанный Email
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResetPasswordResponseBodyOK'
        '400':
          description: Некорректные данные
        '404':
          description: Пользователь с указанным Email не найден
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResetPasswordResponseBodyNotFound'
      tags: *ref_0
  /profiles:
    get:
      operationId: ProfilesController_findAll
      summary: Получить все профили
      parameters: []
      responses:
        '200':
          description: Профили успешно получены
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UserProfileResponseBodyOK'
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: &ref_1
        - profiles
      security: &ref_3
        - &ref_2
          bearer: []
  /profiles/me:
    get:
      operationId: ProfilesController_findProfileByToken
      summary: Получить текущий профиль
      parameters:
        - name: authorization
          required: true
          in: header
          description: Access токен
          schema:
            type: string
      responses:
        '200':
          description: Профиль успешно получен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserProfileResponseBodyOK'
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_1
      security:
        - *ref_2
        - bearer: []
  /profiles/{id}:
    get:
      operationId: ProfilesController_findOne
      summary: Получить профиль по id
      parameters:
        - name: id
          required: true
          in: path
          description: Идентификатор профиля
          example: 64f81ba37571bfaac18a857f
          schema:
            type: string
      responses:
        '200':
          description: Профиль успешно получен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserProfileResponseBodyOK'
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_1
      security: *ref_3
    patch:
      operationId: ProfilesController_update
      summary: Обновить данные профиля по id
      parameters:
        - name: id
          required: true
          in: path
          description: Идентификатор профиля
          example: 64f81ba37571bfaac18a857f
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateProfileDto'
      responses:
        '200':
          description: Профиль успешно обновлен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserProfileResponseBodyOK'
        '400':
          description: Неверный запрос
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_1
      security: *ref_3
    delete:
      operationId: ProfilesController_remove
      summary: Удалить профиль по id
      parameters:
        - name: id
          required: true
          in: path
          description: Идентификатор профиля
          example: 64f81ba37571bfaac18a857f
          schema:
            type: string
      responses:
        '200':
          description: Профиль успешно удален
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserProfileResponseBodyOK'
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_1
      security: *ref_3
  /profiles/{id}/accounts:
    get:
      operationId: ProfilesController_findAccountByProfileId
      summary: Получить все аккаунты пользователя по id профиля
      parameters:
        - name: id
          required: true
          in: path
          description: Идентификатор профиля
          example: 64f81ba37571bfaac18a857f
          schema:
            type: string
      responses:
        '200':
          description: Аккаунты профиля успешно получены
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/SingleAccountResponseBodyOK'
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_1
      security: *ref_3
  /tariffs:
    get:
      operationId: TariffsController_findAll
      summary: Получить все тарифы
      parameters: []
      responses:
        '200':
          description: Тарифы успешно получены
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Tariff'
        '403':
          description: Отказ в доступе
      tags: &ref_4
        - tariffs
      security: &ref_5
        - bearer: []
    post:
      operationId: TariffsController_create
      summary: Добавить новый тариф
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateTariffDto'
      responses:
        '201':
          description: Тариф успешно добавлен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Tariff'
        '400':
          description: Неверный запрос
        '403':
          description: Отказ в доступе
        '409':
          description: Такой тариф уже существует
      tags: *ref_4
      security: *ref_5
  /tariffs/{id}:
    get:
      operationId: TariffsController_findOne
      summary: Получить тариф по id
      parameters:
        - name: id
          required: true
          in: path
          description: Идентификатор тарифа
          example: 64f81ba37571bfaac18a857f
          schema:
            type: string
      responses:
        '200':
          description: Тариф успешно получен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Tariff'
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_4
      security: *ref_5
    patch:
      operationId: TariffsController_updateTariff
      summary: Изменить данные тарифа по id
      parameters:
        - name: id
          required: true
          in: path
          description: Идентификатор тарифа
          example: 64f81ba37571bfaac18a857f
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateTariffDto'
      responses:
        '200':
          description: Тариф успешно изменен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Tariff'
        '400':
          description: Неверный запрос
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_4
      security: *ref_5
    delete:
      operationId: TariffsController_remove
      summary: Удалить тариф по id
      parameters:
        - name: id
          required: true
          in: path
          description: Идентификатор тарифа
          example: 64f81ba37571bfaac18a857f
          schema:
            type: string
      responses:
        '200':
          description: Тариф успешно удален
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Tariff'
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_4
      security: *ref_5
  /accounts:
    get:
      operationId: AccountController_findAll
      summary: Получить все аккаунты
      parameters: []
      responses:
        '200':
          description: Запрос выполнен успешно
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/SingleAccountResponseBodyOK'
        '403':
          description: Отказ в доступе
      tags: &ref_6
        - accounts
      security: &ref_7
        - bearer: []
  /accounts/{id}:
    patch:
      operationId: AccountController_update
      summary: Обновить данные аккаунта по id
      parameters:
        - name: id
          required: true
          in: path
          description: Индификатор аккаунта
          example: 64f81ba37571bfaac18a857f
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AccountUpdateRequestBody'
      responses:
        '200':
          description: Аккаунт успешно обновлен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SingleAccountResponseBodyOK'
        '400':
          description: Неверный запрос
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_6
      security: *ref_7
  /logout:
    get:
      operationId: BlacklistTokensController_addToken
      summary: Разлогинить пользователя
      parameters:
        - name: authorization
          required: true
          in: header
          description: Access токен
          schema:
            type: string
      responses:
        '200':
          description: Пользователь успешно разлогинен
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    description: Сообщение об успешном разлогине
      tags:
        - logout
      security:
        - bearer: []
  /bot-accesses:
    post:
      operationId: BotAccessesController_create
      summary: Создает доступ
      description: >-
        Создает запись о доступе пользователя к боту, используется при создании
        бота
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateBotAccessDto'
      responses:
        '201':
          description: Запись о доступе создана.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BotAccess'
        '400':
          description: Неверный запрос
        '403':
          description: Отказ в доступе
      tags: &ref_8
        - botAccesses
      security: &ref_9
        - bearer: []
    get:
      operationId: BotAccessesController_findAll
      summary: Найти все доступы
      parameters: []
      responses:
        '200':
          description: Все доступы найдены.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/BotAccess'
        '403':
          description: Отказ в доступе
      tags: *ref_8
      security: *ref_9
  /bot-accesses/{id}:
    get:
      operationId: BotAccessesController_findOne
      summary: Найти доступ по ID
      description: ВАЖНО! Находит доступ по botAccessId (запись о связи botId и userId)
      parameters:
        - name: id
          required: true
          in: path
          description: Идентификатор botAccessId
          example: 64f81ba37571bfaac18a857f
          schema:
            type: string
      responses:
        '200':
          description: Доступ найден.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BotAccess'
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_8
      security: *ref_9
    patch:
      operationId: BotAccessesController_update
      summary: Изменить уровень доступа
      description: >-
        Изменяет уровень существующего доступа. Должен передаваться полностью
        объект с теми доступами, которые должны быть у пользователя.
      parameters:
        - name: id
          required: true
          in: path
          description: Идентификатор botAccessId
          example: 64f81ba37571bfaac18a857f
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateBotAccessDto'
      responses:
        '200':
          description: Доступ изменен.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BotAccess'
        '400':
          description: Неверный запрос
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_8
      security: *ref_9
    delete:
      operationId: BotAccessesController_delete
      summary: Удалить доступ
      parameters:
        - name: id
          required: true
          in: path
          description: Идентификатор botAccessId
          example: 64f81ba37571bfaac18a857f
          schema:
            type: string
      responses:
        '200':
          description: Доступ удален.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BotAccess'
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_8
      security: *ref_9
  /bot-accesses/{userId}/{botId}:
    get:
      operationId: BotAccessesController_getPermission
      summary: Получить доступ
      description: Позвоялет проверить уровень доступа по botId и userId
      parameters:
        - name: botId
          required: true
          in: path
          description: Идентификатор бота
          example: 64f81ba37571bfaac18a857f
          schema:
            type: string
        - name: userId
          required: true
          in: path
          description: Идентификатор пользователя
          example: 64f81ba37571bfaac18a857f
          schema:
            type: string
      responses:
        '200':
          description: Информация о доступе по botId и userId получена.
          content:
            application/json:
              schema:
                type: Permission
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_8
      security: *ref_9
  /bot-accesses/{botId}:
    post:
      operationId: BotAccessesController_shareAccess
      summary: Поделиться доступом
      description: >-
        Позвоялет поделиться доступом по botId и создать новый доступ, если
        пользователь имеет полный уровень доступа к данному боту
      parameters:
        - name: botId
          required: true
          in: path
          description: Идентификатор бота
          example: 64f81ba37571bfaac18a857f
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ShareBotAccessDto'
      responses:
        '201':
          description: Новый доступ создан.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BotAccess'
        '400':
          description: Неверный запрос
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_8
      security: *ref_9
  /platforms:
    post:
      operationId: PlatformController_create
      summary: Создать новую платформу
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreatePlatformDto'
      responses:
        '201':
          description: Платформа успешно создана
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Platform'
        '400':
          description: Неверный запрос
        '403':
          description: Отказ в доступе
      tags: &ref_10
        - platforms
      security: &ref_11
        - bearer: []
    get:
      operationId: PlatformController_findAll
      summary: Получить все платформы
      parameters: []
      responses:
        '200':
          description: Платформы успешно получены
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Platform'
        '403':
          description: Отказ в доступе
      tags: *ref_10
      security: *ref_11
  /platforms/{id}:
    get:
      operationId: PlatformController_findOne
      summary: Получить платформу по id
      parameters:
        - name: id
          required: true
          in: path
          description: Идентиификатор платформы
          example: 64f81ba37571bfaac18a857f
          schema:
            type: string
      responses:
        '200':
          description: Платформа успешно получена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Platform'
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_10
      security: *ref_11
    patch:
      operationId: PlatformController_update
      summary: Обновить данные о платформе по id
      parameters:
        - name: id
          required: true
          in: path
          description: Идентификатор платформы
          example: 64f81ba37571bfaac18a857f
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdatePlatformDto'
      responses:
        '200':
          description: Платформа успешно обновлена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Platform'
        '400':
          description: Неверный запрос
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_10
      security: *ref_11
    delete:
      operationId: PlatformController_remove
      summary: Удалить платформу по id
      parameters:
        - name: id
          required: true
          in: path
          description: Идентификатор платформы
          example: 64f81ba37571bfaac18a857f
          schema:
            type: string
      responses:
        '200':
          description: Платформа успешно удалена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Platform'
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_10
      security: *ref_11
  /promocodes:
    post:
      operationId: PromocodesController_create
      summary: Добавить новый промокод
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreatePromocodeDto'
      responses:
        '201':
          description: Промокод успешно добавлен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Promocode'
        '403':
          description: Отказ в доступе
        '409':
          description: Такой промокод уже существует
      tags: &ref_12
        - promocodes
      security: &ref_13
        - bearer: []
    get:
      operationId: PromocodesController_findAll
      summary: Получить все промокоды
      parameters: []
      responses:
        '200':
          description: Промокоды успешно получены
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Promocode'
        '403':
          description: Отказ в доступе
      tags: *ref_12
      security: *ref_13
  /promocodes/promocode:
    get:
      operationId: PromocodesController_findOneByCode
      summary: Получить промокод по названию
      parameters:
        - name: code
          required: true
          in: query
          schema:
            type: string
      responses:
        '200':
          description: Промокод успешно получен
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Promocode'
        '403':
          description: Отказ в доступе
      tags: *ref_12
      security: *ref_13
    patch:
      operationId: PromocodesController_updateByCode
      summary: Использовать промокод 1 раз
      parameters:
        - name: code
          required: true
          in: query
          schema:
            type: string
      responses:
        '200':
          description: Промокод успешно обновлен
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Promocode'
        '403':
          description: Отказ в доступе
      tags: *ref_12
      security: *ref_13
  /promocodes/{id}:
    get:
      operationId: PromocodesController_findOne
      summary: Получить промокод по id
      parameters:
        - name: id
          required: true
          in: path
          description: Идентификатор промокода
          example: 64f81ba37571bfaac18a857f
          schema:
            type: string
      responses:
        '200':
          description: Промокод успешно получен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Promocode'
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_12
      security: *ref_13
    patch:
      operationId: PromocodesController_update
      summary: Изменить данные промокода по id
      parameters:
        - name: id
          required: true
          in: path
          description: Идентификатор промокода
          example: 64f81ba37571bfaac18a857f
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdatePromocodeDto'
      responses:
        '200':
          description: Данные промокода успешно изменены
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Promocode'
        '400':
          description: Неверный запрос
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_12
      security: *ref_13
    delete:
      operationId: PromocodesController_remove
      summary: Удалить промокод по id
      parameters:
        - name: id
          required: true
          in: path
          description: Идентификатор промокода
          example: 64f81ba37571bfaac18a857f
          schema:
            type: string
      responses:
        '200':
          description: Промокод успешно удален
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Promocode'
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_12
      security: *ref_13
  /bots:
    get:
      operationId: BotsController_findMy
      summary: Получить ботов пользователя
      parameters: []
      responses:
        '200':
          description: Запрос выполнен успешно
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Bot'
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: &ref_14
        - bots
      security: &ref_15
        - bearer: []
    post:
      operationId: BotsController_create
      summary: Создание нового бота
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BotCreateRequestBody'
      responses:
        '201':
          description: Новый бот создан
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Bot'
        '400':
          description: Неверный запрос
        '403':
          description: Отказ в доступе
      tags: *ref_14
      security: *ref_15
  /bots/templates:
    get:
      operationId: BotsController_findTemplates
      summary: Получить ботов пользователя
      parameters: []
      responses:
        '200':
          description: Запрос выполнен успешно
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Bot'
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_14
      security: *ref_15
  /bots/{id}:
    delete:
      operationId: BotsController_remove
      summary: Удаление бота
      parameters:
        - name: id
          required: true
          in: path
          description: Идентификатор бота
          example: 64f81ba37571bfaac18a857f
          schema:
            type: string
      responses:
        '200':
          description: Бот удален
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Bot'
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_14
      security: *ref_15
    patch:
      operationId: BotsController_update
      summary: Смена имени бота
      parameters:
        - name: id
          required: true
          in: path
          description: Идентификатор бота
          example: 64f81ba37571bfaac18a857f
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BotCreateRequestBody'
      responses:
        '200':
          description: Имя бота обновлено
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Bot'
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_14
      security: *ref_15
    get:
      operationId: BotsController_findOne
      summary: Получить данные бота по Id
      parameters:
        - name: id
          required: true
          in: path
          description: Идентификатор бота
          example: 64f81ba37571bfaac18a857f
          schema:
            type: string
      responses:
        '200':
          description: Информация о боте по Id получена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Bot'
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_14
      security: *ref_15
  /bots/{id}/share:
    post:
      operationId: BotsController_share
      summary: Предоставить общий доступ к боту, первичный доступ при отправке email
      parameters:
        - name: id
          required: true
          in: path
          description: Идентификатор бота
          example: 64f81ba37571bfaac18a857f
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ShareBotDto'
      responses:
        '201':
          description: Первичный доступ создан
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Bot'
        '400':
          description: Неверный запрос
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_14
      security: *ref_15
  /subscriptions:
    get:
      operationId: SubscriptionsController_subscriptionAndPayments
      summary: Данные страницы "Подписка и платежи"
      parameters: []
      responses:
        '200':
          description: Данные подписок и платежей успешно получены
          content:
            application/json:
              schema:
                type: object
                properties:
                  tariff:
                    type: string
                    example: Бизнес
                  status:
                    type: boolean
                    example: true
                  cardMask:
                    type: string
                    example: 4500 *** 1119
                  debitDate:
                    type: date
                    example: '2023-09-12'
                  balance:
                    type: number
                    example: 1234
                  payments:
                    type: array
                    items:
                      $ref: '#/components/schemas/Payment'
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: &ref_16
        - subscriptions
      security: &ref_17
        - bearer: []
  /subscriptions/activate:
    post:
      operationId: SubscriptionsController_activateSubscription
      summary: Активировать(отменить) подписку
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                status:
                  type: boolean
                  example: true
      responses:
        '201':
          description: Подписка активирована
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Subscription'
        '400':
          description: Неверный запрос
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_16
      security: *ref_17
  /subscriptions/{id}:
    post:
      operationId: SubscriptionsController_createSubscription
      summary: Оформить подписку
      parameters:
        - name: id
          required: true
          in: path
          description: Идентификатор тарифа
          example: 64f81ba37571bfaac18a857f
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                cardMask:
                  type: string
                  example: 4500 *** 1119
                debitDate:
                  type: date
                  example: '2023-09-12'
      responses:
        '201':
          description: Подписка оформлена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Subscription'
        '400':
          description: Неверный запрос
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_16
      security: *ref_17
  /payments:
    get:
      operationId: PaymentsController_userPayments
      summary: История платежей
      parameters: []
      responses:
        '200':
          description: История платежей успешно получена
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Payment'
        '403':
          description: Отказ в доступе
      tags: &ref_18
        - payments
      security: &ref_19
        - bearer: []
    post:
      operationId: PaymentsController_create
      summary: Добавить данные финансовой операции
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OmitTypeClass'
      responses:
        '201':
          description: Операция успешно добавлена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Payment'
        '400':
          description: Неверный запрос
        '403':
          description: Отказ в доступе
      tags: *ref_18
      security: *ref_19
  /payments/{id}:
    delete:
      operationId: PaymentsController_delete
      summary: Удалить финансовую операцию
      parameters:
        - name: id
          required: true
          in: path
          description: Идентификатор фин.операции
          example: 64f81ba37571bfaac18a857f
          schema:
            type: string
      responses:
        '200':
          description: Операция успешно удалена
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_18
      security: *ref_19
    patch:
      operationId: PaymentsController_update
      summary: Обновить данные финансовой операции
      parameters:
        - name: id
          required: true
          in: path
          description: Идентификатор фин.операции
          example: 64f81ba37571bfaac18a857f
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OmitTypeClass'
      responses:
        '200':
          description: Операция успешно обновлена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Payment'
        '400':
          description: Неверный запрос
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_18
      security: *ref_19
  /notification:
    post:
      operationId: NotificationController_create
      summary: Создать уведомление
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateNotificationDto'
      responses:
        '201':
          description: Уведомление успешно создано
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateNotificationDto'
        '400':
          description: Неверный запрос
        '403':
          description: Отказ в доступе
      tags: &ref_20
        - notification
      security: &ref_21
        - bearer: []
    get:
      operationId: NotificationController_getAll
      summary: Все уведомления
      parameters: []
      responses:
        '200':
          description: Уведомления успешно получены
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Notification'
        '403':
          description: Отказ в доступе
      tags: *ref_20
      security: *ref_21
  /notification/{id}:
    get:
      operationId: NotificationController_findOne
      summary: Получить уведомление по id
      parameters:
        - name: id
          required: true
          in: path
          description: Идентификатор уведомления
          example: 64f81ba37571bfaac18a857f
          schema:
            type: string
      responses:
        '200':
          description: Уведомление успешно получено
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Notification'
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_20
      security: *ref_21
    delete:
      operationId: NotificationController_remove
      summary: Удалить уведомление
      parameters:
        - name: id
          required: true
          in: path
          description: Идентификатор уведомления
          example: 64f81ba37571bfaac18a857f
          schema:
            type: string
      responses:
        '200':
          description: Уведомление успешно удалено
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Notification'
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_20
      security: *ref_21
    patch:
      operationId: NotificationController_update
      summary: Изменить уведомление
      parameters:
        - name: id
          required: true
          in: path
          description: Идентификатор уведомления
          example: 64f81ba37571bfaac18a857f
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateNotificationDto'
      responses:
        '200':
          description: Уведомление успешно изменено
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UpdateNotificationDto'
        '400':
          description: Неверный запрос
        '403':
          description: Отказ в доступе
        '404':
          description: Ресурс не найден
      tags: *ref_20
      security: *ref_21
info:
  title: API BotKits
  description: Ручки для команды frontend
  version: '1.0'
  contact: {}
tags:
  - name: auth
    description: Авторизация пользователей
  - name: accounts
    description: Аккаунты пользователей
  - name: profiles
    description: Профили пользователей
  - name: bots
    description: Боты
  - name: botAccesses
    description: Управление доступами к ботам
  - name: platforms
    description: Подключаемые платформы
  - name: tariffs
    description: Тарифы работы с площадкой
  - name: subscriptions
    description: Подписки пользователей на тарифы
  - name: payments
    description: Платежи пользователей
  - name: promocodes
    description: Промокоды
  - name: notification
    description: Уведомления пользователей
servers: []
components:
  securitySchemes:
    bearer:
      scheme: bearer
      bearerFormat: JWT
      type: http
  schemas:
    SignInRequestBody:
      type: object
      properties:
        email:
          type: string
          example: test@mail.ru
          description: Почта пользователя
        password:
          type: string
          example: '123'
          description: Пароль пользователя
      required:
        - email
        - password
    SigninResponseBodyOK:
      type: object
      properties:
        _id:
          type: string
          example: 650b396ed4201e5ca499f3b5
        type:
          type: string
          example: local
        role:
          type: string
          example: user
        credentials:
          type: object
          example:
            email: test@mail.ru
            accessToken: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9
            refreshToken: eyJhbGciOiJIUzI1NiIsInR5cPCI6IkpXVCJ9
        profile:
          type: object
          example:
            _id: 650b396dd4201e5ca499f3b3
            username: test
            phone: '+79999999999'
            avatar: https://i.pravatar.cc/300
            balance: 0
        success:
          type: boolean
          example: true
      required:
        - credentials
        - profile
    SigninResponseBodyNotOK:
      type: object
      properties:
        message:
          type: string
          example: Неверное имя пользователя или пароль
          description: Сообщение об ошибке
        error:
          type: string
          example: Unauthorized
          description: Тип ошибки
        statusCode:
          type: number
          example: 401
          description: HTTP-статус код
    SignUpRequestBody:
      type: object
      properties:
        password:
          type: string
          example: '123'
          description: Пароль пользователя
        email:
          type: string
          example: test@mail.ru
          description: Email пользователя
        phone:
          type: string
          example: '+79999999999'
          description: Телефонный номер пользователя
        username:
          type: string
          example: test
          description: Имя пользователя
      required:
        - password
        - email
        - phone
        - username
    SignupResponseBodyNotOK:
      type: object
      properties:
        message:
          type: string
          example: Аккаунт уже существует
          description: Сообщение об ошибке
        error:
          type: string
          example: Conflict
          description: Тип ошибки
        statusCode:
          type: number
          example: 409
          description: HTTP-статус код
    RefreshRequestBody:
      type: object
      properties:
        refreshToken:
          type: string
          example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9
          description: Выданный рефреш токен
      required:
        - refreshToken
    refreshTokenResponseBodyOK:
      type: object
      properties:
        accessToken:
          type: string
          example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9
          description: accessToken по умолчанию действует 1 день
        refreshToken:
          type: string
          example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9
          description: refreshToken по умолчанию действует 7 день
    refreshTokenResponseBodyNotOK:
      type: object
      properties:
        message:
          type: string
          example: Невалидный refreshToken
          description: Сообщение об ошибке
        error:
          type: string
          example: Unauthorized
          description: Тип ошибки
        statusCode:
          type: number
          example: 401
          description: HTTP-статус код
    CodeFlowAuthRequestBody:
      type: object
      properties:
        codeAuth:
          type: string
          example: '432532'
          description: Код авторизации yandex
      required:
        - codeAuth
    Account:
      type: object
      properties: {}
    ResetPasswordRequestBody:
      type: object
      properties:
        email:
          type: string
          example: test@mail.ru
          description: Почта пользователя
      required:
        - email
    ResetPasswordResponseBodyOK:
      type: object
      properties:
        message:
          type: string
          example: 'Ссылка на сброс пароля отправлена на ваш email: test@mail.ru'
          description: Сообщение об успешном сбросе пароля
    ResetPasswordResponseBodyNotFound:
      type: object
      properties:
        message:
          type: string
          example: Пользователь с указанным Email не найден
          description: Сообщение об ошибке
        error:
          type: string
          example: Not Found
          description: Тип ошибки
        statusCode:
          type: number
          example: 404
          description: HTTP-статус код
    UserProfileResponseBodyOK:
      type: object
      properties:
        _id:
          type: string
          example: 65196b9715b55bd51b039144
          description: ' '
        username:
          type: string
          example: test
          description: ' '
        phone:
          type: string
          example: '+79999999999'
          description: ' '
        avatar:
          type: string
          example: https://i.pravatar.cc/300
          description: ' '
        balance:
          type: number
          example: 0
          description: ' '
        accounts:
          type: array
          example:
            - 65196b9715b55bd51b039144
        success:
          type: boolean
          example: true
      required:
        - _id
        - username
        - phone
        - avatar
        - balance
        - accounts
    SingleAccountResponseBodyOK:
      type: object
      properties:
        _id:
          type: string
          example: 6516ab8f2c612e8cce53e45f
        type:
          type: string
          example: local
        role:
          type: string
          example: user
        credentials:
          type: object
          example:
            email: test@mail.ru
            accessToken: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9
            refreshToken: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9
        profile:
          type: string
          example: 6516ab8f2c612e8cce53e45d
        success:
          type: boolean
          example: true
      required:
        - credentials
    UpdateProfileDto:
      type: object
      properties: {}
    Tariff:
      type: object
      properties:
        name:
          type: string
          example: Старт
        price:
          type: number
          example: 390
      required:
        - name
        - price
    CreateTariffDto:
      type: object
      properties:
        name:
          type: string
          example: Старт
        price:
          type: number
          minimum: 1
          example: 390
      required:
        - name
        - price
    UpdateTariffDto:
      type: object
      properties: {}
    AccountUpdateRequestBody:
      type: object
      properties:
        type:
          type: string
          example: local
        role:
          type: string
          example: user
        credentials:
          type: object
          example:
            email: test@mail.ru
      required:
        - credentials
    CreateBotAccessDto:
      type: object
      properties:
        botId:
          type: string
          description: Id бота
          example: 64ff94ef12477f1d0934c614
        permission:
          type: object
          description: уровень доступа
          example: &ref_22
            voronki: viewer
      required:
        - botId
        - permission
    Profile:
      type: object
      properties:
        username:
          type: string
          example: Ivan Ivanov
        phone:
          type: string
          example: '+79501364578'
        avatar:
          type: string
          example: https://i.pravatar.cc/300
        balance:
          type: number
          example: 1400
        accounts:
          type: array
          items:
            type: string
      required:
        - username
        - phone
        - avatar
        - balance
        - accounts
    Bot:
      type: object
      properties: {}
    Permission:
      type: object
      properties:
        voronki:
          type: string
          example: editor
        newsletters:
          type: string
          example: editor
        lists:
          type: string
          example: editor
        statistic:
          type: string
          example: editor
        dialogs:
          type: string
          example: editor
        crm:
          type: string
          example: editor
        mini_landing:
          type: string
          example: editor
      required:
        - voronki
        - newsletters
        - lists
        - statistic
        - dialogs
        - crm
        - mini_landing
    BotAccess:
      type: object
      properties:
        userId:
          example: 64ff89e7faea577804940275
          allOf:
            - $ref: '#/components/schemas/Profile'
        botId:
          example: 64ff89e7faea577804940275
          allOf:
            - $ref: '#/components/schemas/Bot'
        permission:
          example:
            voronki: editor
            newsletters: editor
            lists: editor
            statistic: editor
            dialogs: editor
            crm: editor
            mini_landing: editor
          allOf:
            - $ref: '#/components/schemas/Permission'
      required:
        - userId
        - botId
        - permission
    UpdateBotAccessDto:
      type: object
      properties:
        permission:
          description: уровень доступа
          allOf:
            - $ref: '#/components/schemas/Permission'
      required:
        - permission
    ShareBotAccessDto:
      type: object
      properties:
        email:
          type: string
          description: Email зарегистрированного пользователя
          example: test@test.ru
        permission:
          type: object
          description: уровень доступа
          example: *ref_22
      required:
        - email
        - permission
    FormFields:
      type: object
      properties:
        name:
          type: boolean
          example: true
        pages:
          type: boolean
          example: true
        accessKey:
          type: boolean
          example: false
        url:
          type: boolean
          example: true
      required:
        - name
        - pages
        - accessKey
        - url
    CreatePlatformDto:
      type: object
      properties:
        icon:
          type: string
          example: >-
            https://cdn.icon-icons.com/icons2/1233/PNG/512/1492718766-vk_83600.png
        title:
          type: string
          example: VK
        formFields:
          $ref: '#/components/schemas/FormFields'
      required:
        - icon
        - title
        - formFields
    Platform:
      type: object
      properties: {}
    UpdatePlatformDto:
      type: object
      properties: {}
    CreatePromocodeDto:
      type: object
      properties:
        code:
          type: string
          example: PROMO50
        actionPeriod:
          format: date-time
          type: string
          example: '2023-09-10T16:07:34.285Z'
        activationCount:
          type: number
          minimum: 0
          example: 2
        maxActivationCount:
          type: number
          minimum: 1
          example: 10
        amount:
          type: number
          minimum: 1
          example: 1500
      required:
        - code
        - actionPeriod
        - activationCount
        - maxActivationCount
        - amount
    Promocode:
      type: object
      properties:
        code:
          type: string
          example: PROMO50
        actionPeriod:
          format: date-time
          type: string
          example: '2023-09-10T16:07:34.285Z'
        activationCount:
          type: number
          example: 2
        maxActivationCount:
          type: number
          example: 10
        amount:
          type: number
          example: 1500
      required:
        - code
        - actionPeriod
        - activationCount
        - maxActivationCount
        - amount
    UpdatePromocodeDto:
      type: object
      properties: {}
    BotCreateRequestBody:
      type: object
      properties:
        isTemplate:
          type: boolean
          example: 'false'
          description: ''
        icon:
          type: string
          example: >-
            https://cdn.icon-icons.com/icons2/1233/PNG/512/1492718766-vk_83600.png
        title:
          type: string
          example: Создание заказов
          description: ''
        description:
          type: string
          example: Бот для создания заказов
        features:
          type: array
          example:
            - Создание заказов
            - Редактирование заказов
        messenger:
          type: object
          example:
            name: VK
            pages:
              - vk.com/club1245321223
            accessKey: 1685494522:AAHzRs4YFqckLvBVARVoUL0c3B1GFqlDpo
            url: www.some-url.com
        settings:
          type: object
          example:
            settings:
              Приветствие: Я бот-автоответчик
              Инлайн_кнопка: Текст кнопки
      required:
        - isTemplate
        - title
        - messenger
        - settings
    ShareBotDto:
      type: object
      properties:
        email:
          type: string
          description: Email зарегистрированного пользователя
          example: test@test.ru
      required:
        - email
    Subscription:
      type: object
      properties:
        status:
          type: boolean
          example: true
          default: false
        cardMask:
          type: string
          example: 4500 *** 1119
        debitDate:
          format: date-time
          type: string
          example: 2023-10-15T09:02:55.897Z
      required:
        - status
        - cardMask
        - debitDate
    Payment:
      type: object
      properties:
        date:
          format: date-time
          type: string
          example: 2023-10-15T09:02:55.899Z
        amount:
          type: number
          example: 1000
        successful:
          type: boolean
          example: true
        operation:
          type: string
          enum:
            - Поступление
            - Списание
          example: Поступление
        note:
          type: string
          example: Пополнение счета
          default: '-'
      required:
        - date
        - amount
        - successful
        - operation
        - note
    OmitTypeClass:
      type: object
      properties:
        date:
          format: date-time
          type: string
          example: '2023-01-03'
        amount:
          type: number
          example: '1234'
        successful:
          type: boolean
          example: true
        operation:
          enum:
            - Поступление
            - Списание
          type: string
          example: Поступление
        note:
          type: string
          example: Пополнение счета
      required:
        - date
        - amount
        - successful
        - operation
        - note
    ObjectId:
      type: object
      properties: {}
    FromWhom:
      type: object
      properties:
        profileId:
          description: id отправителя
          nullable: false
          allOf:
            - $ref: '#/components/schemas/ObjectId'
      required:
        - profileId
    ToWhom:
      type: object
      properties:
        fromId:
          description: id получателя
          nullable: false
          allOf:
            - $ref: '#/components/schemas/ObjectId'
      required:
        - fromId
    CreateNotificationDto:
      type: object
      properties:
        fromWhom:
          description: id отправителя
          nullable: false
          allOf:
            - $ref: '#/components/schemas/FromWhom'
        toWhom:
          description: id получателя
          nullable: false
          allOf:
            - $ref: '#/components/schemas/ToWhom'
        message:
          type: object
          description: содержимое
          nullable: false
      required:
        - fromWhom
        - toWhom
        - message
    Notification:
      type: object
      properties:
        fromWhom:
          description: id отправителя
          nullable: false
          allOf:
            - $ref: '#/components/schemas/FromWhom'
        toWhom:
          description: id получателя
          nullable: false
          allOf:
            - $ref: '#/components/schemas/ToWhom'
        message:
          type: object
          description: содержание
          nullable: false
        isReceived:
          type: boolean
          description: Статус получения
          nullable: false
      required:
        - fromWhom
        - toWhom
        - message
        - isReceived
    UpdateNotificationDto:
      type: object
      properties:
        message:
          type: string
          example: Изменены настройки бота
        isReceived:
          type: boolean
          example: false
